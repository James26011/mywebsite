{
  "hash": "c61eb6c84ab9f59e56e9aeddaaabb488",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: LS 빅데이터 스쿨 Homework 5\nauthor: 이태현\ndate: '2024-07-30'\ncategoty:\n  - bigdata\n---\n\n# 2024-07-30(화)\n\n::: {#52ac649b .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport seaborn as sns\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import norm\n```\n:::\n\n\n# 챕터 9-2 설문조사 그래프에서 각 성별 95% 신뢰구간 계산후 그리기. norm.ppf() 사용해서 그릴 것. 모분산은 표본 분산을 사용해서 추정하기\n\n::: {#f02a6820 .cell execution_count=2}\n``` {.python .cell-code}\n# 파일 불러오기\nraw_welfare = pd.read_spss('C:/Users/USER/Documents/LS빅데이터스쿨/portfolio/data/koweps/Koweps_hpwc14_2019_beta2.sav')\n\nwelfare=raw_welfare.copy()\n\n# 변수명 전처리\nwelfare=welfare.rename(\n    columns = {\n        \"h14_g3\": \"sex\",\n        \"h14_g4\": \"birth\",\n        \"h14_g10\": \"marriage_type\",\n        \"h14_g11\": \"religion\",\n        \"p1402_8aq1\": \"income\",\n        \"h14_eco9\": \"code_job\",\n        \"h14_reg7\": \"code_region\"\n    }\n)\n\n# 필요한 칼럼만 추출하기\nwelfare=welfare[[\"sex\", \"birth\", \"marriage_type\",\n                \"religion\", \"income\", \"code_job\", \"code_region\"]]\n\n# 성별 변수 변경\nwelfare[\"sex\"] = np.where(welfare[\"sex\"] == 1,'male', 'female')\nwelfare[\"sex\"].value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```\nsex\nfemale    7913\nmale      6505\nName: count, dtype: int64\n```\n:::\n:::\n\n\n::: {#141af453 .cell execution_count=3}\n``` {.python .cell-code}\n# 성별에 따른 월급 그래프 그리기\nsex_income=welfare.dropna(subset=\"income\") \\\n                  .groupby(\"sex\", as_index=False) \\\n                  .agg(mean_income = (\"income\", \"mean\"))\n\nsns.barplot(data=sex_income, x=\"sex\", y=\"mean_income\",\n            hue=\"sex\")\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-4-output-1.png){width=593 height=429}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n::: {#fd81c784 .cell execution_count=4}\n``` {.python .cell-code}\n# 표준편차, 표본 갯수 구하기\nsex_income = welfare.dropna(subset=[\"income\"]) \\\n                    .groupby(\"sex\", as_index=False) \\\n                    .agg(mean_income=(\"income\", \"mean\"), \n                         std_income=(\"income\", \"std\"), \n                         count=(\"income\", \"size\"))\n\n# 신뢰구간 계산\nconfidence = 0.95\nz = norm.ppf((1 + confidence) / 2)\n\n# 신뢰구간 계산\nsex_income['ci_lower'] = sex_income['mean_income'] - z * (sex_income['std_income'] / np.sqrt(sex_income['count']-1))\nsex_income['ci_upper'] = sex_income['mean_income'] + z * (sex_income['std_income'] / np.sqrt(sex_income['count']-1))\n\n# 시각화\nplt.figure(figsize=(10, 6))\nsns.barplot(data=sex_income, x=\"sex\", y=\"mean_income\", hue=\"sex\", ci=None)\nplt.errorbar(sex_income['sex'], sex_income['mean_income'], \n             yerr=[sex_income['mean_income'] - sex_income['ci_lower'], \n                   sex_income['ci_upper'] - sex_income['mean_income']], \n             fmt='none', color='black', capsize=10)\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nC:\\Users\\USER\\AppData\\Local\\Temp\\ipykernel_15096\\2885580581.py:18: FutureWarning:\n\n\n\nThe `ci` parameter is deprecated. Use `errorbar=None` for the same effect.\n\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-5-output-2.png){width=816 height=503}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}